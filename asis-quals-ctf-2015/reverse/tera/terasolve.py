import requests
from hexdump import hexdump

xorbuf = [
0x000000f2,
0x0000009a,
0x00000083,
0x00000012,
0x00000039,
0x00000045,
0x000000e7,
0x000000f4,
0x0000006f,
0x000000a1,
0x00000006,
0x000000e7,
0x00000095,
0x000000f3,
0x00000090,
0x000000f2,
0x000000f0,
0x0000006b,
0x00000033,
0x000000e3,
0x000000a8,
0x00000078,
0x00000037,
0x000000d5,
0x00000044,
0x00000039,
0x00000061,
0x0000008a,
0x000000fb,
0x00000022,
0x000000fa,
0x0000009e,
0x000000e7,
0x00000011,
0x00000039,
0x000000a6,
0x000000f3,
0x00000033
]

offbuf = [
0x0000004c89617cf4,
0x000000b4b5e95f83,
0x000000e4598d686b,
0x00000136a62674ef,
0x000001837a65beb7,
0x0000019fa831467c,
0x000002a6202acd01,
0x000004493f10645e,
0x000004cdce6d65e4,
0x000005028ec8de7e,
0x0000056219504a56,
0x000005bd2d191db8,
0x0000072bd5d02592,
0x0000073dee6d04fe,
0x00000a25e5afe320,
0x00000a73b464fb9e,
0x00000b6259f6e34b,
0x00000b9aa45094dc,
0x00000bc548e0ea39,
0x00000c7ac41ecc56,
0x00000c85f073fb8b,
0x00000c92536a9116,
0x00000d930be6dabf,
0x00000e61b989da40,
0x00000f37999ca268,
0x00000fb7c59b9d1f,
0x00001018d3a3939d,
0x000010202aed0369,
0x000010e8fb926cf3,
0x0000113bc38ea065,
0x000013257504044f,
0x000014fb0612dc3c,
0x000016572370da92,
0x0000173d75634441,
0x00001b9d0f2d9374,
0x00001ba90de42d8e,
0x00001be9ef4c8f3e,
0x00001bfda4b84e00
]

url = 'http://darksky.slac.stanford.edu/simulations/ds14_a/ds14_a_1.0000'
headers = {}

#for i in range(0,len(xorbuf),4): hexdump(xorbuf[i])

flag = ''
for idx, offset in enumerate(offbuf):
	headers['Range'] = 'bytes={0}-{0}'.format(offset)
	r = requests.get(url, headers = headers)
	flag += chr(ord(r.content[0]) ^ xorbuf[idx])
	print flag
print flag
